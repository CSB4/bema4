<script type="text/javascript">

function headerAnimate() {

	var header = document.getElementById("header");
		winHeight = window.innerHeight;
		winWidth = window.innerWidth;
		headerImg = header.getElementsByTagName("img")[0];
		aspectRatio = 274/375;
		imgFinalHeight = 48;
		imgFinalMarginLeft = 10;

		imgHeight = winHeight * 0.6;
		imgMarginLeftInitial = (winWidth - (imgHeight * aspectRatio)) / 2;

		x = winHeight/imgMarginLeftInitial;

		headerImg.style.marginLeft = imgMarginLeftInitial + "px";
		headerImg.style.height = imgHeight + "px";

	onscroll = function() {

		var scrollTop = document.body.scrollTop;
			threshold = scrollTop > (winHeight - 50);

			imgHeight = (winHeight - scrollTop) * 0.6;
			imgMarginLeft = (winHeight - scrollTop) / x;

			if (imgHeight > imgFinalHeight) {
				headerImg.style.height = imgHeight + "px";
				headerImg.style.webkitTransition = "";
			} else {
				headerImg.style.height = imgFinalHeight + "px";
				headerImg.style.webkitTransition = 'height .4s';


			}

			if (imgMarginLeft > imgFinalMarginLeft) {
				headerImg.style.marginLeft = imgMarginLeft + "px";
				headerImg.style.webkitTransition = "";
			} else {
				headerImg.style.marginLeft = imgFinalMarginLeft + "px";
				headerImg.style.webkitTransition = 'margin-left .4s';
			}

			headerImg.style.marginTop = (winHeight * 0.2 + scrollTop * 0.8) + "px";


	  	if (threshold) {
			 header.className = header.className.replace(/\b initial\b/,' initiated');
			 headerImg.style.marginTop = "";
		} else {
			 header.className = header.className.replace(/\b initiated\b/,' initial');
		}
	}
}



function addImg(imgUrl, divId) {
		var img = document.createElement("img");
		var src = document.getElementById(divId);

		img.src = imgUrl;
		img.className = "bg-image";

		src.appendChild(img);
}

function disableLinksByElement(el) {
  if (document.getElementById && document.getElementsByTagName) {
    if (typeof(el) == 'string') {
      el = document.getElementById(el);
    }
    var anchors = el.getElementsByTagName('a');
    for (var i=0, end=anchors.length; i<end; i++) {
      anchors[i].onclick = function() {
        return false;
      };
    }
  }
}
disableLinksByElement('galeria');

enquire.register("screen and (min-width: 640px)", [{

    deferSetup : true,

    setup : function () {

      Modernizr.load([
        {
          load: ['https://maps.googleapis.com/maps/api/js?v=3.exp&callback=initialize',
                '{{site.baseurl}}/javascript/fastclick.js',
                'https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js',
          		'{{site.baseurl}}/javascript/responsive-nav.js',
          		'{{site.baseurl}}/javascript/scroll.js',
                '{{site.baseurl}}/javascript/fixed-responsive-nav.js',
                '{{site.baseurl}}/javascript/gallery.js',
                 '{{site.baseurl}}/javascript/imagesloaded.js',
                 '{{site.baseurl}}/javascript/imgfill.js'],

          complete : function() {


                    smoothScroll.init();

          	  		function setHeight() {
					  	windowHeight = $(window).innerHeight();
					    $('.mh-100, #historia').css('min-height', windowHeight);
					};

					setHeight();

				  	$(window).resize(function() {
				    	setHeight();
				  	});

					jQuery('.mh-100').imagefill();


					$(function() {
						Grid.init();
					});


			$(function() {

	            var content = $('.content');
	            var lat_lng = new google.maps.LatLng(54.513208, 18.540717);
	            var mapOptions = {
	                center: lat_lng,
	                zoom: 17,
	                panControl: false,
	                streetViewControl: false,
	                zoomControl: false,
	                mapTypeControl: false,
	                mapTypeId: google.maps.MapTypeId.ROADMAP
	            };
	            var map_loaded = false;
	            var map = new google.maps.Map(document.getElementById("map"), mapOptions);

	            var marker = new google.maps.Marker({
	                position: lat_lng,
	                map: map,
	                title: 'Centrum Stomatologiczne Bema 4'
	            });

	            var overlay = new google.maps.OverlayView();
	            overlay.draw = function() {};
	            overlay.setMap(map);

	            function updateGoogleLogoToBeVisible() {
	              if (map_loaded) {
	                var logo = $("#map div a img").parentsUntil("a").parentsUntil("div").parent();
	                logo.css("margin-left", $(".content").width() + 5);
	              }
	            }

	            function updateMapCenter() {
	              if (map_loaded) {
	                map.setCenter(lat_lng);
	                var map_div = $("#map");
	                var x = map_div.width() - $(".slide-kontakt .wrapper").width();
	                var latlng = overlay.getProjection().fromContainerPixelToLatLng(new google.maps.Point(x/2, map_div.height()/2));
	                map.panTo(latlng);
	              }
	            }
	            google.maps.event.addListener(marker, 'click', function() {
				  window.location.href = "https://www.google.pl/maps/place/Bema+4.+Centrum+stomatologiczne/@54.5131757,18.5409225,18z/data=!4m2!3m1!1s0x46fda731b042040b:0xef62ec1f389b1572";
				});
	            google.maps.event.addListenerOnce(map, 'idle', function() {
	              map_loaded = true;
	              updateGoogleLogoToBeVisible();
	              updateMapCenter();
	            });

	        });
          }
        },
      ]);

      addImg('/images/test.jpg', 'uslugi');
    }

  }]);
enquire.register("screen and (max-width: 640px)", [{

    deferSetup : true,

    setup : function () {


      Modernizr.load([
        {
          load: ['{{site.baseurl}}/javascript/fastclick.js',
          		'{{site.baseurl}}/javascript/responsive-nav.js',
          		'{{site.baseurl}}/javascript/scroll.js',
                '{{site.baseurl}}/javascript/fixed-responsive-nav.js'],

          complete : function() {

                    smoothScroll.init();
                    headerAnimate();

          }
        },
      ]);

    },
    unmatch : function () {
    	document.getElementById("header").getElementsByTagName("img")[0].style.height = "";
    	document.getElementById("header").getElementsByTagName("img")[0].style.marginLeft = "";
    },
    match : function () {
    	headerAnimate();
    }

  }]);
</script>
